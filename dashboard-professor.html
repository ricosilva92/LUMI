<!DOCTYPE html>
<html lang="pt-PT">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LUMI â€” Dashboard do Professor</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Poppins:wght@700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="assets/css/style.css" />

  <!-- Overrides de tema (cores / brand) -->
  <style>
    :root{
      /* Paleta clara */
      --brand: #5E8B6F;
      --brand-strong:#4b735c;
      --bg: #f7faf8;
      --text: #0f172a;
      --muted: #64748b;
      --card: #ffffff;
      --line: rgba(2,6,23,0.08);
      --sidebar-bg: #eef5f0;
    }
    /* Aplica variÃ¡veis base (caso o style.css nÃ£o o faÃ§a) */
    body{ background: var(--bg); color: var(--text); }
    .card{ background: var(--card); border:1px solid var(--line); }
    .sidebar{ background: var(--sidebar-bg); border-right:1px solid var(--line); }
    .nav .btn.btn-primary, .btn.btn-primary{ background: var(--brand); border-color: var(--brand); }
    .btn.btn-primary:hover{ background: var(--brand-strong); border-color: var(--brand-strong); }
    a, .link{ color: var(--brand); }

    /* Paleta escura (ativa com .dark-mode no <body>) */
    .dark-mode{
      --bg: #0f1419;
      --text: #e6edf3;
      --muted: #9aa7b3;
      --card: #111820;
      --line: rgba(148,163,184,0.18);
      --sidebar-bg: #0d1712;
      --brand: #5E8B6F;           /* mantÃ©m a brand */
      --brand-strong:#4b735c;
    }
    .dark-mode .site-header,
    .dark-mode .card,
    .dark-mode .sidebar{ background: var(--card); }
    .dark-mode .card, .dark-mode .sidebar{ border-color: var(--line); }
    .dark-mode a, .dark-mode .link{ color: var(--brand); }
    .stat__value{ color: var(--brand); }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="site-header">
    <nav class="nav">
      <a class="logo" href="index.html" aria-label="InÃ­cio">
        <img src="assets/img/horizontal.png" alt="LUMI" style="height:40px" />
        <span>LUMI</span>
      </a>
      <div class="nav-links">
        <button id="themeToggle" class="btn" title="Alternar modo" aria-pressed="false" aria-label="Ativar modo escuro">ğŸŒ™</button>
        <a href="dashboard-professor.html">Dashboard</a>
        <a href="dashboard-aluno.html">Ver como aluno</a>
        <button class="btn btn-green">Sair</button>
      </div>
    </nav>
  </header>

  <!-- Layout -->
  <div class="layout">
    <!-- Sidebar -->
    <aside class="sidebar">
      <ul>
        <li><a href="#overview">ğŸ  Overview</a></li>
        <li><a href="#turmas">ğŸ« Turmas</a></li>
        <li><a href="#alunos">ğŸ‘¨â€ğŸ“ Alunos</a></li>
        <li><a href="#avaliacao">ğŸ“ AvaliaÃ§Ã£o</a></li>
        <li><a href="#mensagens">ğŸ’¬ Mensagens</a></li>
        <li><a href="#relatorios">ğŸ“‘ RelatÃ³rios</a></li>
        <li><a href="#config">âš™ï¸ Config</a></li>
      </ul>
    </aside>

    <!-- ConteÃºdo -->
    <main class="content">
      <!-- OVERVIEW -->
      <section id="overview" class="card">
        <h1>OlÃ¡, Professor JoÃ£o ğŸ‘‹</h1>
        <p class="muted">Resumo rÃ¡pido das tuas turmas hoje.</p>
        <div class="grid grid-3 mt-3">
          <div class="stat"><div class="stat__value">3</div><div class="stat__label">Turmas</div></div>
          <div class="stat"><div class="stat__value">69</div><div class="stat__label">Alunos</div></div>
          <div class="stat"><div class="stat__value">8</div><div class="stat__label">IntervenÃ§Ãµes pendentes</div></div>
        </div>
        <h2 class="mt-3">Alertas do LUMI ğŸ¤–</h2>
        <ul>
          <li>ğŸ”” 3 alunos abaixo de 60% em Ãlgebra (7Âº A).</li>
          <li>ğŸ‰ 7Âº B subiu +8% em HistÃ³ria esta semana.</li>
          <li>ğŸ“Œ 7Âº C: 5 exercÃ­cios pendentes em CiÃªncias.</li>
        </ul>
      </section>

      <!-- TURMAS -->
      <section id="turmas" class="card mt-3">
        <h1>Turmas atribuÃ­das</h1>
        <div class="grid grid-3 mt-2">
          <div class="card"><h3>7Âº A</h3><p class="muted">24 alunos</p></div>
          <div class="card"><h3>7Âº B</h3><p class="muted">22 alunos</p></div>
          <div class="card"><h3>7Âº C</h3><p class="muted">23 alunos</p></div>
        </div>
      </section>

      <!-- ALUNOS -->
      <section id="alunos" class="card mt-3">
        <h1>Alunos â€” Progresso</h1>
        <table style="width:100%;border-collapse:collapse">
          <thead>
            <tr>
              <th>Aluno</th><th>Turma</th><th>Disciplina</th><th>Progresso</th><th>Ãšltimo resultado</th><th>Estado</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Mariana Silva<br><span class="muted">mariana@escola.pt</span></td>
              <td>7Âº A</td><td>MatemÃ¡tica</td><td>72%</td><td>Ãlgebra 42%</td><td>ğŸŸ¡ AtenÃ§Ã£o</td>
            </tr>
            <tr>
              <td>JoÃ£o Reis<br><span class="muted">joao@escola.pt</span></td>
              <td>7Âº A</td><td>PortuguÃªs</td><td>85%</td><td>Leitura B1 78%</td><td>ğŸŸ¢ Ok</td>
            </tr>
            <tr>
              <td>InÃªs Ramos<br><span class="muted">ines@escola.pt</span></td>
              <td>7Âº B</td><td>HistÃ³ria</td><td>63%</td><td>Descobrimentos 60%</td><td>ğŸŸ¡ AtenÃ§Ã£o</td>
            </tr>
            <tr>
              <td>Tiago Lopes<br><span class="muted">tiago@escola.pt</span></td>
              <td>7Âº C</td><td>CiÃªncias</td><td>78%</td><td>Energia 70%</td><td>ğŸŸ¢ Ok</td>
            </tr>
            <tr>
              <td>Rita Costa<br><span class="muted">rita@escola.pt</span></td>
              <td>7Âº B</td><td>InglÃªs</td><td>54%</td><td>Reading A2 52%</td><td>ğŸ”´ CrÃ­tico</td>
            </tr>
          </tbody>
        </table>
      </section>

      <!-- AVALIAÃ‡ÃƒO -->
      <section id="avaliacao" class="card mt-3">
        <h1>AvaliaÃ§Ã£o</h1>
        <p class="muted">Ãšltimos registos</p>
        <ul>
          <li>Mariana Silva â€” Nota: <strong>42</strong> â€” Precisa reforÃ§ar Ãlgebra</li>
          <li>JoÃ£o Reis â€” Nota: <strong>78</strong> â€” Bom desempenho</li>
          <li>Rita Costa â€” Nota: <strong>52</strong> â€” AtenÃ§Ã£o Ã  gramÃ¡tica</li>
        </ul>
      </section>

      <!-- MENSAGENS -->
      <section id="mensagens" class="card mt-3">
        <h1>Mensagens Ã  Turma</h1>
        <div class="chat-box" id="msgBox" aria-live="polite">
          <div class="msg you">ğŸ“¢ Estudem para o teste de MatemÃ¡tica amanhÃ£!</div>
          <div class="msg student">Ok professor ğŸ‘</div>
          <div class="msg student">Vamos rever os exercÃ­cios em casa.</div>
        </div>
        <div class="quick-replies" style="display:flex;gap:.4rem;flex-wrap:wrap;margin-top:.4rem">
          <span class="chip" data-template="Excelente trabalho hoje! ğŸ‘" style="padding:.25rem .6rem;border:1px solid var(--line);border-radius:999px;cursor:pointer">ğŸ‘ Excelente trabalho</span>
          <span class="chip" data-template="Tragam o manual amanhÃ£. ğŸ“˜" style="padding:.25rem .6rem;border:1px solid var(--line);border-radius:999px;cursor:pointer">ğŸ“˜ Manual amanhÃ£</span>
          <span class="chip" data-template="Entreguem a ficha 3 atÃ© 6Âª-feira. ğŸ—“ï¸" style="padding:.25rem .6rem;border:1px solid var(--line);border-radius:999px;cursor:pointer">ğŸ—“ï¸ Ficha 3 atÃ© 6Âª</span>
        </div>
        <div class="chat-composer" style="display:flex;gap:.6rem;margin-top:.6rem">
          <input id="msgInput" class="input" type="text" placeholder="Escreve uma mensagem e carrega Enterâ€¦" />
          <button class="btn btn-green nowrap" id="sendBtn">Enviar</button>
          <button class="btn nowrap" id="clearBtn">Limpar</button>
        </div>
      </section>

      <!-- RELATÃ“RIOS -->
      <section id="relatorios" class="card mt-3">
        <h1>RelatÃ³rios</h1>
        <div class="form-row" style="gap:.6rem;flex-wrap:wrap">
          <label>Turma:
            <select id="relTurma" class="select">
              <option value="7Âº A">7Âº A</option><option value="7Âº B">7Âº B</option><option value="7Âº C">7Âº C</option>
            </select>
          </label>
          <label>Disciplina:
            <select id="relDisc" class="select">
              <option value="">Todas</option><option>PortuguÃªs</option><option>MatemÃ¡tica</option><option>HistÃ³ria</option><option>CiÃªncias</option><option>InglÃªs</option>
            </select>
          </label>
          <div class="btn-row" style="display:flex;gap:.6rem;flex-wrap:wrap">
            <button class="btn btn-primary" id="btnGerar">Gerar</button>
            <button class="btn" id="btnCopiar">Copiar</button>
            <button class="btn" id="btnCSV">Exportar CSV</button>
            <button class="btn" id="btnPrint">Imprimir</button>
          </div>
        </div>
        <pre id="relOut" class="mt-3" style="max-height:320px;overflow:auto">
=== RelatÃ³rio (exemplo) ===
Selecione turma/disciplinas e clique em "Gerar".
        </pre>
      </section>

      <!-- CONFIG -->
      <section id="config" class="card mt-3">
        <h1>ConfiguraÃ§Ã£o</h1>
        <p><strong>NotificaÃ§Ãµes:</strong> Ativadas</p>
        <p><strong>Partilha com EE:</strong> Desativada</p>
      </section>
    </main>
  </div>

  <footer class="site-footer">
    <p>Projeto Escola do Futuro â€“ Leiria â€¢ 2025</p>
  </footer>

  <script>
    /* ===== Tema com Ã­cone correto + persistÃªncia ===== */
    (function(){
      const btn = document.getElementById('themeToggle');
      const saved = localStorage.getItem('lumi_theme');
      const initial = saved === 'dark' ? 'dark' : 'light';
      applyTheme(initial);

      btn.addEventListener('click', () => {
        const next = document.body.classList.contains('dark-mode') ? 'light' : 'dark';
        applyTheme(next);
      });

      function applyTheme(mode){
        document.body.classList.remove('light-mode','dark-mode');
        document.body.classList.add(mode+'-mode');
        // Ã­cone e acessibilidade
        if(mode==='dark'){
          btn.textContent = 'ğŸŒ™';
          btn.setAttribute('aria-label','Modo escuro ativo â€” mudar para claro');
          btn.setAttribute('aria-pressed','true');
        }else{
          btn.textContent = 'â˜€ï¸';
          btn.setAttribute('aria-label','Modo claro ativo â€” mudar para escuro');
          btn.setAttribute('aria-pressed','false');
        }
        localStorage.setItem('lumi_theme', mode);
      }
    })();

    /* ===== Mensagens (UX simples) ===== */
    const msgBox = document.getElementById('msgBox');
    const msgInput = document.getElementById('msgInput');
    document.getElementById('sendBtn').addEventListener('click', sendMsg);
    document.getElementById('clearBtn').addEventListener('click', () => { msgBox.innerHTML=''; });
    msgInput.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ e.preventDefault(); sendMsg(); }});
    document.querySelectorAll('.chip').forEach(chip=>{
      chip.addEventListener('click', ()=>{ msgInput.value = chip.dataset.template; msgInput.focus(); });
    });
    function sendMsg(){
      const text = msgInput.value.trim(); if(!text) return;
      msgBox.insertAdjacentHTML('beforeend', `<div class="msg you">${escapeHTML(text)}</div>`);
      msgInput.value=''; msgBox.scrollTop = msgBox.scrollHeight;
    }
    function escapeHTML(s){return s.replace(/[&<>"']/g, m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));}

    /* ===== RelatÃ³rios (dummy) ===== */
    const ALUNOS = [
      { nome:'Mariana Silva', email:'mariana@escola.pt', turma:'7Âº A', disc:'MatemÃ¡tica', prog:72, ultimo:'Ãlgebra 42%', estado:'ğŸŸ¡ AtenÃ§Ã£o' },
      { nome:'JoÃ£o Reis', email:'joao@escola.pt', turma:'7Âº A', disc:'PortuguÃªs', prog:85, ultimo:'Leitura B1 78%', estado:'ğŸŸ¢ Ok' },
      { nome:'InÃªs Ramos', email:'ines@escola.pt', turma:'7Âº B', disc:'HistÃ³ria', prog:63, ultimo:'Descobrimentos 60%', estado:'ğŸŸ¡ AtenÃ§Ã£o' },
      { nome:'Tiago Lopes', email:'tiago@escola.pt', turma:'7Âº C', disc:'CiÃªncias', prog:78, ultimo:'Energia 70%', estado:'ğŸŸ¢ Ok' },
      { nome:'Rita Costa', email:'rita@escola.pt', turma:'7Âº B', disc:'InglÃªs', prog:54, ultimo:'Reading A2 52%', estado:'ğŸ”´ CrÃ­tico' }
    ];
    const relTurma = document.getElementById('relTurma');
    const relDisc  = document.getElementById('relDisc');
    const relOut   = document.getElementById('relOut');

    document.getElementById('btnGerar').addEventListener('click', ()=>{
      const turma = relTurma.value, disc = relDisc.value;
      const rows = ALUNOS.filter(a => a.turma===turma && (disc==='' || a.disc===disc));
      const now = new Date();
      const head = `=== RelatÃ³rio (${now.toLocaleDateString()} ${now.toLocaleTimeString()}) ===\nTurma: ${turma} | Disciplina: ${disc||'Todas'}\nTotal alunos: ${rows.length}\n`;
      const body = rows.length ? '\n' + rows.map(a => `- ${a.nome} â€” ${a.disc}: ${a.prog}% (${a.ultimo}) ${a.estado}`).join('\n') : '\n(sem resultados)';
      relOut.textContent = head + body;
    });
    document.getElementById('btnCopiar').addEventListener('click', async ()=>{
      try{ await navigator.clipboard.writeText(relOut.textContent); alert('RelatÃ³rio copiado.'); }
      catch{ alert('NÃ£o foi possÃ­vel copiar.'); }
    });
    document.getElementById('btnCSV').addEventListener('click', ()=>{
      const turma = relTurma.value, disc = relDisc.value;
      const rows = ALUNOS.filter(a => a.turma===turma && (disc==='' || a.disc===disc))
        .map(a => ({nome:a.nome,email:a.email,turma:a.turma,disciplina:a.disc,progresso:a.prog,ultimo:a.ultimo,estado:a.estado}));
      if(!rows.length){ alert('Sem dados para exportar.'); return; }
      const csv = toCSV(rows);
      download('relatorio.csv', csv, 'text/csv');
    });
    document.getElementById('btnPrint').addEventListener('click', ()=>{ window.print(); });

    function toCSV(rows){
      const esc = v => `"${String(v).replace(/"/g,'""')}"`;
      const head = Object.keys(rows[0]).map(esc).join(',');
      const body = rows.map(r => Object.values(r).map(esc).join(',')).join('\n');
      return head+'\n'+body;
    }
    function download(filename, content, type='text/plain'){
      const blob = new Blob([content], {type});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href=url; a.download=filename;
      document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>
